{"version":3,"sources":["webpack:///../app/server.js?1bab"],"names":[],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;AACA;;;;AACA;;;;AAEA,KAAM,MAAM,oBAAN;AACN,KAAM,SAAS,oBAAQ,EAAR,GAAT;AACN,KAAM,WAAW,6BAAY,QAAZ,IAAwB,WAAxB;AACjB,KAAM,OAAO,6BAAY,IAAZ,IAAoB,IAApB;;AAEb,KAAM,QAAQ,kBAAG,YAAH,CAAgB,YAAhB,EAA8B,MAA9B,CAAR;;AAEN,UAAS,OAAT,CAAiB,QAAjB,EAA2B;AACzB,QAAK,IAAI,IAAI,CAAJ,EAAO,MAAM,MAAN,GAAe,CAAf,EAAkB,KAAK,CAAL,EAAQ;AACxC,aAAQ,GAAR,CAAY,MAAM,CAAN,CAAZ,EADwC;AAExC,SAAI,MAAM,CAAN,EAAS,SAAT,KAAuB,QAAvB,EAAiC;AACnC,cAAO,MAAM,CAAN,CAAP,CADmC;MAArC;IAFF;AAMA,UAAO,KAAP,CAPyB;EAA3B;;;;;;;;;;;;;;AAsBA,KAAI,SAAS,oBAAQ,EAAR,CAAT;;AAEJ,uBAAO,GAAP,EAAY;AACV,SAAM,kBAAQ,IAAR,CAAa,KAAb,CAAN;AACA,WAAQ,OAAR;AACA,YAAS,MAAT;AACA,UAAO,KAAP;AACA,UAAO,IAAP;EALF;;AAQA,KAAI,GAAJ,CAAQ,yBAAM,QAAN,CAAR;;AAEA,QAAO,GAAP,CAAW,mBAAX,0BAAgC,iBAAW,IAAX;OAE1B;;;;;AADJ,mBAAQ,GAAR,CAAY,KAAK,OAAL,CAAZ;AACI,kBAAO,QAAQ,MAAR;;AACX,kBAAO,MAAP,CAAc,OAAO,IAAP,CAAY,QAAZ,EAAsB;AAClC,oBAAO,KAAK,KAAL;AACP,0BAAa,KAAK,UAAL;AACb,4BAAe,KAAK,UAAL;AACf,2BAAc,KAAK,UAAL;AACd,mBAAM,SAAN;AACA,kBAAK,KAAK,OAAL,CAAa,IAAb;YANP;;kBAQM,KAAK,MAAL,CAAY,OAAZ,EAAqB,EAAE,eAAgB,MAAhB,EAAvB;;;;;;;;EAXwB,CAAhC;;AAcA,QAAO,GAAP,CAAW,GAAX,0BAAgB,kBAAW,IAAX;;;;;;kBACR,KAAK,MAAL,CAAY,OAAZ,EAAqB,EAAE,eAAgB,MAAhB,EAAvB;;;;;;;;EADQ,CAAhB;;;;;;;;;;;;;;AAgBA,KAAI,GAAJ,CAAQ,wBAAR;;AAEA,KAAI,GAAJ,CAAQ,OAAO,MAAP,EAAR;;AAEA,KAAI,GAAJ,CAAQ,OAAO,cAAP,EAAR;;AAEA,KAAI,GAAJ,CAAQ,4BAAR;;AAEA,KAAI,GAAJ,CAAQ,6BAAR;;AAEA,KAAI,MAAJ,CAAW,IAAX,EAAiB,YAAa;;AAE5B,WAAQ,IAAR,CAAa,4BAAb,EAF4B;AAG5B,WAAQ,IAAR,CAAa,4BAAb,EAA2C,QAA3C,EAAqD,IAArD,EAH4B;EAAb,CAAjB;;AAMA,KAAI,IAAJ,EAAa;AACX,OAAI,MAAY;AACd,aAAQ,GAAR,CAAY,uCAAZ,EADc;AAEd,YAAO,GAAP,CAAW,MAAX,GAFc;AAGd,YAAO,GAAP,CAAW,gBAAX,CAA4B,UAAC,MAAD,EAAY;AACtC,WAAI,WAAW,OAAX,EAAoB;AACtB,oBAAW;kBAAM,QAAQ,IAAR,CAAa,CAAb;UAAN,EAAuB,CAAlC,EADsB;QAAxB;MAD0B,CAA5B,CAHc;IAAhB","file":"0.df1d3fb0ea248c3f8508.hot-update.js","sourcesContent":["import axios from 'axios';\nimport helpers from '../configs/helpers';\nimport koa from 'koa';\nimport compress from 'koa-compress';\nimport fs from 'fs-extra';\nimport serve from 'koa-static';\nimport proxy from 'koa-proxy';\nimport userAgent from 'koa-useragent';\nimport request from 'koa-request';\nimport cors from 'koa-cors';\nimport logger from 'koa-logging';\nimport path from 'path';\nimport render from 'koa-ejs';\nimport webpack from 'webpack';\nimport webpackDevMiddleware from 'koa-webpack-dev';\nimport webpackHotMiddleware from 'koa-webpack-hot-middleware';\n\nimport { DESCRIPTION, IMAGE_URL, SERVER_URL, SITE_NAME } from './scripts/constants/constants';\nimport HtmlCompilerWatcher from '../configs/htmlCompilerWatcher';\nimport 'babel-polyfill';\n\nconst app = koa();\nconst router = require('koa-router')();\nconst hostname = process.env.HOSTNAME || 'localhost';\nconst port = process.env.PORT || 8000;\n\nconst posts = fs.readJsonSync('cache.json', 'utf8');\n\nfunction getPost(titleUrl) {\n  for (let i = 0; posts.length > i; i += 1) {\n    console.log(posts[i]);\n    if (posts[i].title_url === titleUrl) {\n      return posts[i];\n    }\n  }\n  return false;\n}\n\n// axios.get(`${SERVER_URL}/posts`).then((response) => {\n//   fs.writeFile('./cache.json', JSON.stringify(response.data), 'utf8', (error) => {\n//     console.error(error);\n//     fs.readFile('./cache.json', 'utf8', (err, data) => {\n//       if (err) throw err;\n//       console.log('cache.json', data.toString());\n//     });\n//   });\n// });\n\n// console.log(getPost('test'));\n\nlet config = require('../configs/webpack.server');\n\nrender(app, {\n  root: helpers.root('app'),\n  layout: 'index',\n  viewExt: 'html',\n  cache: false,\n  debug: true\n});\n\napp.use(serve('static'));\n\nrouter.get('/posts/:title_url', function *(next) {\n  console.log(this.request);\n  let data = getPost('test');\n  Object.assign(config.meta.metadata, {\n    title: data.title,\n    description: data.subheading,\n    publishedTime: data.created_at,\n    modifiedTime: data.updated_at,\n    type: 'article',\n    url: this.request.href\n  });\n  yield this.render('index', { webpackConfig : config });\n});\n\nrouter.get('*', function *(next) {\n  yield this.render('index', { webpackConfig : config });\n});\n\n// function applyMeta(request, data) {\n//   data = JSON.parse(data.body);\n//   Object.assign(META, {\n//     title: data.title,\n//     description: data.description,\n//     publishedTime: data.created_at,\n//     modified_time: data.updated_at,\n//     url: request.href\n//   });\n//   compiler.apply(new HtmlCompilerWatcher(META));\n// }\n\napp.use(cors());\n\napp.use(router.routes());\n\napp.use(router.allowedMethods());\n\napp.use(compress());\n\napp.use(userAgent());\n\napp.listen(port, (...args) => {\n  // console.log('args: ', ...args);\n  console.info('==> âœ…  Server is listening');\n  console.info('==> ðŸŒŽ  Go to http://%s:%s', hostname, port);\n});\n\nif (__DEV__) {\n  if (module.hot) {\n    console.log('[HMR] Waiting for server-side updates');\n    module.hot.accept();\n    module.hot.addStatusHandler((status) => {\n      if (status === 'abort') {\n        setTimeout(() => process.exit(0), 0);\n      }\n    });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ../app/server.js\n **/"],"sourceRoot":""}