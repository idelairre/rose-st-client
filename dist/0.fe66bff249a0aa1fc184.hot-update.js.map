{"version":3,"sources":["webpack:///../app/server.js?1bab"],"names":[],"mappings":"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","file":"0.fe66bff249a0aa1fc184.hot-update.js","sourcesContent":["import compress from 'koa-compress';\nimport cors from 'koa-cors';\nimport fs from 'fs-extra';\nimport helpers from '../configs/helpers';\nimport koa from 'koa';\nimport logger from 'koa-logging';\nimport path from 'path';\nimport proxy from 'koa-proxy';\nimport render from 'koa-ejs';\nimport request from 'koa-request';\nimport schedule from 'node-schedule';\nimport serve from 'koa-static';\nimport userAgent from 'koa-useragent';\nimport webpack from 'webpack';\nimport webpackDevMiddleware from 'koa-webpack-dev';\nimport webpackHotMiddleware from 'koa-webpack-hot-middleware';\n\nimport { DESCRIPTION, IMAGE_URL, SERVER_URL, SITE_NAME } from './scripts/constants/constants';\n\nimport 'babel-polyfill';\n\nconst app = koa();\nconst router = require('koa-router')();\nconst hostname = process.env.HOSTNAME || 'localhost';\nconst port = process.env.PORT || 8000;\n\nfunction getPost(titleUrl) {\n  let posts = fs.readJsonSync('cache.json', 'utf8');\n  for (let i = 0; posts.length > i; i += 1) {\n    console.log(posts[i]);\n    if (posts[i].title_url === titleUrl) {\n      return posts[i];\n    }\n  }\n  return false;\n}\n\nconst task = schedule.scheduleJob('*/42 * * * *', function () {\n  const options = {\n    method: 'GET',\n    url: `${SERVER_URL}/posts`\n  };\n  axios.get(`${SERVER_URL}/posts`).then(response => {\n    fs.writeJsonSync('cache.json', JSON.stringify(response.data));\n    console.log(fs.readJsonSync('cache.json', 'utf8'));\n  });\n});\n\nlet config = require('../configs/webpack.server');\n\nrender(app, {\n  root: helpers.root('app'),\n  layout: 'index',\n  viewExt: 'html',\n  cache: false,\n  debug: true\n});\n\napp.use(serve('static'));\n\nrouter.get('/posts/:title_url', function *(next) {\n  const data = getPost(this.params.title_url);\n  Object.assign(config.meta.metadata, {\n    title: data.title,\n    description: data.subheading,\n    publishedTime: data.created_at,\n    modifiedTime: data.updated_at,\n    type: 'article',\n    url: this.request.href\n  });\n  yield this.render('index', { webpackConfig : config });\n});\n\nrouter.get('*', function *(next) {\n  yield this.render('index', { webpackConfig : config });\n});\n\napp.use(cors());\n\napp.use(router.routes());\n\napp.use(router.allowedMethods());\n\napp.use(compress());\n\napp.use(userAgent());\n\napp.listen(port, (...args) => {\n  // console.log('args: ', ...args);\n  console.info('==> âœ…  Server is listening');\n  console.info('==> ðŸŒŽ  Go to http://%s:%s', hostname, port);\n});\n\nif (__DEV__) {\n  if (module.hot) {\n    console.log('[HMR] Waiting for server-side updates');\n    module.hot.accept();\n    module.hot.addStatusHandler((status) => {\n      if (status === 'abort') {\n        setTimeout(() => process.exit(0), 0);\n      }\n    });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ../app/server.js\n **/"],"sourceRoot":""}